---
title: "Case Study 1"
author: "Michael Daniel Bigler and Liam Arthur Phan"
date: "`r Sys.Date()`"
output:
  rmdformats::downcute:
    code_folding: hide
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(
	message = FALSE,
	warning = FALSE,
	include = TRUE,
	fig.align = "center")
rm(list = ls())
cat("\014")

```

# Packages

```{r packages}

library(ggplot2)
library(DT)

```

# Exercise 1

## Dataset

```{r load data}

df <- read.csv('Case_Study_1.csv')
datatable(df)

```

## Scatterplot

```{r Scatter plot}

A <- df$manufacturing_cost[1]
b <- mean((log(df$manufacturing_cost)-log(A))/log(df$number_of_solar_panels))

experience_curve <- function(X, A, b){
  Y <- A*X^b
  return(Y)
}

df$Y_func <- experience_curve(df$number_of_solar_panels, A, b)
  
Plot1 <- ggplot(df, aes(x=number_of_solar_panels, y=manufacturing_cost)) + geom_point(color="#32A287") + theme_minimal() + labs(title = "Experience Curve",subtitle = "Scatterplot", x="Solar Pannels", y="Manufacturing Cost", caption = "Case Study 1") + geom_line(aes(y=Y_func), colour="#F0C987", size=1)

Plot1

```

## Formula

$$
Y = AX^b
$$

> We want a linear relationship, thus log transformation:

$$
\log(Y) = \log(A) + b*\log(X)
$$

## Beta Parameters Estimation

```{r Beta Estimation}

b <- mean(log(df$manufacturing_cost/A)/log(df$number_of_solar_panels))

```

## Data Log Transformation

```{r Data Transformation}

df_log <- df

df_log$number_of_solar_panels <- log(df_log$number_of_solar_panels)
df_log$manufacturing_cost <- log(df_log$manufacturing_cost)

```

## Scatterplot Log

```{r Scatter plot Log}

A_log <- df_log$manufacturing_cost[1]

Plot2 <- ggplot(df_log, aes(x=number_of_solar_panels, y=manufacturing_cost)) + geom_point(color="#32A287") + theme_minimal() + labs(title = "Experience Curve - Log Data",subtitle = "Scatterplot", x="log(Number of Solar Pannels)", y="log(Manufacturing Cost)", caption = "Case Study 1")

Plot2

```

# Exercise 2

## Log Linear Regression

```{r Estimates}

intercept <- A_log

fit <- lm(I(df_log$number_of_solar_panels - intercept) ~ 0 + df_log$manufacturing_cost, df_log)

b_log <- fit$coefficients

summary(fit)


```

## Scatterplot and Regression

```{r Linear Regression}

Plot2 <- ggplot(df_log, aes(x=number_of_solar_panels, y=manufacturing_cost)) + geom_point(color="#32A287") + theme_minimal() + labs(title = "Experience Curve - Log Data",subtitle = "Scatterplot", x="log(Number of Solar Pannels)", y="log(Manufacturing Cost)", caption = "Case Study 1") + geom_abline(intercept = intercept, slope = b_log, color="#F0C987", size=1) 

Plot2

```

## Learning Rate

$$
b = Slope \: Coefficient = log(learning\: rate)/log_2 
$$

$$
Slope \: of \: the \: experience \: rate = 2^b
$$

```{r Learning Rate}


Learning_Rate <- 2^(b_log)


```
